
{% extends 'core/base.html' %}
{% load static %}
{% load filters %}
{% block content %}
  <section class="checkout">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <div class="checkout__detail__info">
            <div class="create__acount_checkout"> 
              <h4>Checkout</h4>
              {% if not request.user.is_authenticated %}
                <div class="signin__checkout">
                  <span class="signin__title">
                    <strong> sign in or create account</strong> 
                    already use krave? sign with your account
                  </span>
                </div>
                <div class="create__accoutn__button">
                  <button class="button__new_account" href="{% url 'core:register' %}">create account</button>
                  <button class="button_sign_in" href="{% url 'login' %}">sign in</button>
                </div>
              {% endif %}
              <div  class="delivery__detail">
                <div class="delivery__address">
                   <h5>delivery detail</h5>
                    <span>san franciso</span>       
                </div>
                
                <div class="delivery__time">
                    {{ lists.0.restaurant.delivery_time }} min
                  <span>Estimated arrival</span>      
                </div>
                <div class="payment_chekout">
                  <h5>payment</h5>
                  <span>Sign in or create an account to see payment options.</span>
                </div>
              </div>
            </div>
            <div class="adding_items">
              <div class="items__container">
                <span><strong>items ({{ lists.count }})</strong>form {{ lists.0.restaurant.name }}</span>
                <div class="add_item_categ">
                     <a href="{% url 'core:restaurant-detail' lists.0.restaurant.name|space_to_underscore %}">add items</a>
                </div>
              </div>
            </div>
            {% for item in lists %}
            <div class="added__item_list">
              <div class="list__item__head">
                <div class="item__title">{{ item.food.name }}</div>
                <div class="checkout__order__list">
                  <p>
                      <span id="minus1" class="qty__btn food__qty__dec minus">
                        <img src="{% static 'images/food__pop__desc.png' %}" alt="">
                      </span>

                      <input id="qty1" type="text" value="{{ item.number_of_food }}" class="qty" />
                      <span id="add1" class="qty__btn food__qty__inc add">
                        <img src="{% static 'images/food__pop__inc.png' %}" alt="">
                      </span>
                  </p>
                </div>
                <div class="added__item_price">${{ item.get_total }}</div>
             </div>
             <div class="selected__items">

                  <span>${{ item.food.new_price }}</span>
                  {% for modifier in item.modifier.all %}
                    <span>{{ modifier.name_of_ingredient }} - ${{ modifier.cost_of_addition }}</span>
                  {% endfor %}
                  <div class="edit__selected__items">
                    <a href="#">Edit</a>
                  </div>
                </div>
            </div>
            {% endfor %}
            <form class="comment__box">
              <textarea rows="3" cols="80" name="comment" form="" placeholder="Leave a note for the resturent..."></textarea>
            </form>
          </div>
        </div>
        <div class="col-md-6">
          <div class="payment__summary">
            <h5>Order Summary</h5>
            <div class="summary__detail__info">
              <div class="icon__info">
                <i class="fa fa-shopping-basket" aria-hidden="true"></i>
                <span class="icon__bucket">{{ lists.count }} items from {{ lists.0.restaurant.name }}</span>
              </div>
              <div class="icon__info">
                <i class="fa fa-clock-o" aria-hidden="true"></i>
                <span class="icon__timing">Arriving in {{ lists.0.restaurant.delivery_time }} min</span>
              </div>
              <div class="icon__info">
                <i class="fa fa-map-marker" aria-hidden="true"></i>
                <span class="icon__location"> San Francisco</span>
              </div>
              </div>
            <div class="grand__total">
              <div class="subtotal">
                <span>Subtotal</span>
                <span id="total_price" data-id="{{ lists|get_total_price }}">${{ lists|get_total_price }}</span>
              </div>
              <div class="subtotal">
                <span>Delivery Fee</span>
                <span id="delivery_cost" data-id="{{ lists.0.restaurant.delivery_charge }}">${{ lists.0.restaurant.delivery_charge }}</span>
              </div>
              <div class="total__grand__sum">
                <span>Total</span>
                <span id="total"></span>
              </div>
              <div class="grand__total__button">
                <button>Place Order</button>
              </div>
            </div>
          </div>
          
        </div>
        
      </div>
    </div>
  </section>
  {% include 'core/footer.html' %}
  {% endblock %}
  {% block scripts %}
  <script>
    $(document).ready(function(){
      var food_total = $("#total_price").attr("data-id");
      var delivery_cost = $("#delivery_cost").attr("data-id");
      var total = parseInt(food_total) + parseInt(delivery_cost);
      $("#total").html("$" + total);
    });
  </script>
  {% endblock %}